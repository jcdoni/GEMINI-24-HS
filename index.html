<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playlist Editor - Management Tool</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            blue: '#00a8e1',
                            bg: '#00050d',
                            panel: '#0a111f',
                            card: '#0f172a',
                            border: 'rgba(255,255,255,0.06)'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* ESTILO IDENTICO AO IPTVEDITOR */
        * { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; letter-spacing: -0.01em; }
        body { background-color: #00050d; color: #f8fafc; overflow-x: hidden; }

        /* SCROLLBAR GOURMET */
        ::-webkit-scrollbar { width: 5px; height: 5px; }
        ::-webkit-scrollbar-track { background: #00050d; }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #00a8e1; }

        /* NAVBAR FIXED GLASS */
        .header-glass { 
            background: rgba(0, 5, 13, 0.85); 
            backdrop-filter: blur(12px); 
            border-bottom: 1px solid rgba(255,255,255,0.05);
            z-index: 100;
        }

        /* REVEAL ENGINE (SCROLL ANIMATION) */
        .reveal { opacity: 0; transform: translateY(30px); transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        .reveal.active { opacity: 1; transform: translateY(0); }

        /* CARDS DE PREÇO IDENTICOS */
        .pricing-card {
            background: #0a111f;
            border-radius: 2.5rem;
            border: 1px solid rgba(255,255,255,0.05);
            transition: all 0.3s ease;
        }
        .pricing-card:hover { transform: translateY(-8px); border-color: #00a8e1; }

        /* WORKSTATION GRID */
        .editor-container { 
            display: grid; 
            grid-template-columns: 280px 1fr 340px; 
            height: calc(100vh - 64px); 
            overflow: hidden;
        }
        .panel { overflow-y: auto; height: 100%; border-right: 1px solid rgba(255,255,255,0.05); }

        /* TABELA PROFISSIONAL */
        .editor-table { width: 100%; border-collapse: separate; border-spacing: 0; }
        .editor-table th { 
            position: sticky; top: 0; z-index: 10; background: #050a14; 
            color: #64748b; font-size: 11px; font-weight: 800; text-transform: uppercase; 
            padding: 14px; border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .editor-table td { padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,0.02); font-size: 13px; }
        .editor-table tr:hover { background: rgba(0, 168, 225, 0.05); cursor: pointer; }
        .editor-table tr.selected { background: rgba(0, 168, 225, 0.12) !important; border-left: 3px solid #00a8e1; }

        /* BOTÕES DE AÇÃO */
        .btn-action { background: #00a8e1; color: white; border-radius: 12px; font-weight: 700; transition: all 0.2s; }
        .btn-action:hover { transform: scale(1.02); filter: brightness(1.1); }
    </style>
</head>
<body>

    <div id="app-root">
        
        <header class="header-glass fixed w-full h-16 flex items-center justify-between px-10">
            <div class="flex items-center gap-14">
                <div class="text-2xl font-black tracking-tighter cursor-pointer" onclick="Router.go('landing')">
                    <span class="text-white">IPTV</span><span class="text-brand-blue">EDITOR</span>
                </div>
                <nav class="hidden lg:flex gap-10 text-[11px] font-black uppercase tracking-widest text-gray-500">
                    <button onclick="Router.go('landing')" class="hover:text-white">Home</button>
                    <button class="hover:text-white">FAQ & Guides</button>
                    <button class="hover:text-white">Support</button>
                    <button onclick="Router.go('playlists')" class="hover:text-white">My Account</button>
                </nav>
            </div>
            <div class="flex items-center gap-6">
                <button onclick="Router.go('playlists')" class="bg-brand-blue/10 border border-brand-blue/20 text-brand-blue px-6 py-2 rounded-full text-[10px] font-black hover:bg-brand-blue hover:text-white transition-all">MY ACCOUNT</button>
            </div>
        </header>

        <div id="view-landing" class="pt-16">
            <section class="min-h-[85vh] flex flex-col items-center justify-center text-center px-6 reveal active">
                <h1 class="text-6xl md:text-8xl font-black tracking-tighter mb-8 leading-[1.1]">
                    Your playlists, <br><span class="text-brand-blue">made easier</span>
                </h1>
                <p class="text-xl text-gray-500 max-w-2xl mx-auto mb-12 font-medium">
                    Manage your playlists in one place with wide EPG coverage and updated images ready to use.
                </p>
                <div class="flex gap-4">
                    <button onclick="Router.go('playlists')" class="btn-action px-12 py-4 text-sm uppercase tracking-widest">GET STARTED NOW</button>
                </div>
            </section>

            <section class="py-32 bg-black/30">
                <div class="max-w-7xl mx-auto px-10">
                    <div class="text-center mb-20 reveal">
                        <span class="text-brand-blue font-black text-[10px] uppercase tracking-widest">Designed for Users</span>
                        <h2 class="text-4xl font-black mt-4">Core features</h2>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
                        <div class="pricing-card p-12 reveal">
                            <i class="fa-solid fa-layer-group text-3xl text-brand-blue mb-8"></i>
                            <h3 class="text-xl font-black mb-4">Wide compatibility</h3>
                            <p class="text-gray-500 text-sm leading-relaxed">IPTVEditor supports all major formats for both import and export (M3U, Xtream, MAG).</p>
                        </div>
                        <div class="pricing-card p-12 reveal" style="transition-delay: 0.1s">
                            <i class="fa-solid fa-cloud text-3xl text-brand-blue mb-8"></i>
                            <h3 class="text-xl font-black mb-4">Cloud computing</h3>
                            <p class="text-gray-500 text-sm leading-relaxed">Keep your playlists always with you. Save up to 40 playlists on our Cloud space.</p>
                        </div>
                        <div class="pricing-card p-12 reveal" style="transition-delay: 0.2s">
                            <i class="fa-solid fa-bolt text-3xl text-brand-blue mb-8"></i>
                            <h3 class="text-xl font-black mb-4">User friendly</h3>
                            <p class="text-gray-500 text-sm leading-relaxed">No software to download. All you need is your screen and internet connection.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section class="py-32">
                <div class="max-w-5xl mx-auto px-10">
                    <div class="text-center mb-20 reveal">
                        <h2 class="text-4xl font-black mt-4">Pricing Plans</h2>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                        <div class="pricing-card p-12 reveal">
                            <h3 class="text-2xl font-black mb-2">Advanced</h3>
                            <div class="text-4xl font-black mb-10">€14.90 <span class="text-xs text-gray-500">/ year</span></div>
                            <ul class="space-y-4 mb-12 text-sm text-gray-400">
                                <li><i class="fa-solid fa-check text-brand-blue mr-3"></i> Max playlists: 40</li>
                                <li><i class="fa-solid fa-check text-brand-blue mr-3"></i> Entries: 1 million</li>
                                <li><i class="fa-solid fa-check text-brand-blue mr-3"></i> EPG sources: ∞</li>
                            </ul>
                            <button class="btn-action w-full py-4 uppercase text-xs font-black">Purchase Now</button>
                        </div>
                        <div class="pricing-card p-12 reveal" style="transition-delay: 0.1s">
                            <h3 class="text-2xl font-black mb-2">Basic</h3>
                            <div class="text-4xl font-black mb-10">€9.90 <span class="text-xs text-gray-500">/ year</span></div>
                            <ul class="space-y-4 mb-12 text-sm text-gray-400">
                                <li><i class="fa-solid fa-check text-brand-blue mr-3"></i> Max playlists: 3</li>
                                <li><i class="fa-solid fa-check text-brand-blue mr-3"></i> Entries: 100,000</li>
                                <li class="opacity-30"><i class="fa-solid fa-xmark text-red-500 mr-3"></i> No EPG sources</li>
                            </ul>
                            <button class="bg-white/5 border border-white/10 w-full py-4 rounded-xl uppercase text-xs font-black hover:bg-white/10">Purchase Now</button>
                        </div>
                    </div>
                </div>
            </section>

            <footer class="py-20 border-t border-white/5 bg-[#050a14]">
                <div class="max-w-7xl mx-auto px-10 grid grid-cols-2 lg:grid-cols-4 gap-12">
                    <div>
                        <div class="text-xl font-black mb-6">IPTV EDITOR</div>
                        <p class="text-xs text-gray-600">© 2019 - 2026, IPTVEditor.com Clone Engine.</p>
                    </div>
                    <div>
                        <h5 class="text-[10px] font-black uppercase text-white mb-6 tracking-widest">General</h5>
                        <ul class="text-xs text-gray-500 space-y-3">
                            <li class="hover:text-brand-blue cursor-pointer">Home</li>
                            <li class="hover:text-brand-blue cursor-pointer">FAQ & Guides</li>
                            <li class="hover:text-brand-blue cursor-pointer">My Account</li>
                        </ul>
                    </div>
                    <div>
                        <h5 class="text-[10px] font-black uppercase text-white mb-6 tracking-widest">Useful Pages</h5>
                        <ul class="text-xs text-gray-500 space-y-3">
                            <li class="hover:text-brand-blue cursor-pointer">Open a ticket</li>
                            <li class="hover:text-brand-blue cursor-pointer">Contact us</li>
                            <li class="hover:text-brand-blue cursor-pointer">Maintenance</li>
                        </ul>
                    </div>
                    <div>
                        <h5 class="text-[10px] font-black uppercase text-white mb-6 tracking-widest">Legal</h5>
                        <ul class="text-xs text-gray-500 space-y-3">
                            <li class="hover:text-brand-blue cursor-pointer">Terms & Conditions</li>
                            <li class="hover:text-brand-blue cursor-pointer">Privacy Policy</li>
                        </ul>
                    </div>
                </div>
            </footer>
        </div>

        <div id="view-playlists" class="pt-16 hidden min-h-screen">
            <div class="max-w-7xl mx-auto p-12">
                <div class="flex justify-between items-end mb-12">
                    <div>
                        <h2 class="text-4xl font-black">My Playlists</h2>
                        <p class="text-gray-500 mt-2">Manage your M3U and Xtream sources from the cloud.</p>
                    </div>
                    <button onclick="IO.importPrompt()" class="btn-action px-8 py-3.5 flex items-center gap-3 text-[10px] uppercase font-black">
                        <i class="fa-solid fa-plus"></i> NEW PLAYLIST
                    </button>
                </div>
                <div class="bg-brand-panel border border-white/5 rounded-[2rem] overflow-hidden shadow-2xl">
                    <table class="w-full text-left editor-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Channels</th>
                                <th>Status</th>
                                <th>Expiration</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="pl-body"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="view-editor" class="pt-16 hidden">
            <div class="h-14 bg-brand-panel border-b border-white/5 flex items-center justify-between px-8">
                <div class="flex items-center gap-6">
                    <span id="pl-name-label" class="text-[10px] font-black uppercase text-brand-blue">Playlist Editor</span>
                    <div class="h-5 w-px bg-white/10"></div>
                    <div class="flex gap-2">
                        <button class="bg-brand-blue text-white px-4 py-1 rounded-[6px] text-[10px] font-black">CHANNELS</button>
                        <button class="bg-white/5 text-gray-500 px-4 py-1 rounded-[6px] text-[10px] font-black">VOD</button>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <input type="text" id="ch-search" onkeyup="Editor.renderChannels()" placeholder="Filter channels..." class="bg-black/50 border border-white/10 rounded-full px-5 py-1.5 text-[10px] outline-none focus:border-brand-blue w-64">
                    <button class="bg-brand-blue/10 text-brand-blue border border-brand-blue/20 px-4 py-1.5 rounded text-[10px] font-black uppercase">Tools</button>
                </div>
            </div>

            <div class="editor-container">
                <aside class="panel border-r border-white/5">
                    <div class="p-5 border-b border-white/5 flex justify-between items-center">
                        <span class="text-[10px] font-black text-gray-500 uppercase">Groups</span>
                        <span id="group-count" class="bg-brand-blue/10 text-brand-blue px-2 py-0.5 rounded text-[9px] font-black">0</span>
                    </div>
                    <div id="group-list" class="p-2 space-y-1"></div>
                </aside>

                <main class="panel bg-black/20">
                    <table class="editor-table">
                        <thead>
                            <tr>
                                <th class="w-10"><input type="checkbox"></th>
                                <th class="w-14">Icon</th>
                                <th>Name</th>
                                <th>EPG Link</th>
                                <th class="w-10">#</th>
                            </tr>
                        </thead>
                        <tbody id="channel-list"></tbody>
                    </table>
                </main>

                <aside class="panel border-l border-white/5 p-8">
                    <h3 class="text-[10px] font-black text-brand-blue uppercase mb-10 tracking-[0.2em]">Attributes</h3>
                    <div id="prop-empty" class="text-center py-20 opacity-20">
                        <i class="fa-solid fa-mouse-pointer text-4xl mb-4"></i>
                        <p class="text-[10px] font-black">SELECT CHANNEL</p>
                    </div>
                    <div id="prop-editor" class="hidden space-y-6">
                        <div class="space-y-2">
                            <label class="text-[9px] font-black text-gray-600 uppercase">Friendly Name</label>
                            <input type="text" id="attr-name" class="w-full bg-black border border-white/10 p-4 rounded-xl text-sm focus:border-brand-blue outline-none">
                        </div>
                        <div class="space-y-2">
                            <label class="text-[9px] font-black text-gray-600 uppercase">Icon URL</label>
                            <input type="text" id="attr-logo" class="w-full bg-black border border-white/10 p-4 rounded-xl text-sm focus:border-brand-blue outline-none">
                        </div>
                        <div class="space-y-2">
                            <label class="text-[9px] font-black text-gray-600 uppercase">EPG Source</label>
                            <input type="text" id="attr-epg" class="w-full bg-black border border-white/10 p-4 rounded-xl text-sm focus:border-brand-blue outline-none">
                        </div>
                        <button onclick="Editor.saveChanges()" class="btn-action w-full py-4 text-xs uppercase font-black mt-6">Apply Changes</button>
                    </div>
                </aside>
            </div>
        </div>
    </div>

    <div id="toast-container" class="fixed bottom-10 right-10 z-[300]"></div>

    <script>
        const AppState = { playlists: [], currentPL: null, currentGroup: null, editingChannel: null };

        const DB = {
            instance: null,
            init() {
                const req = indexedDB.open("MirrorDB_v8", 1);
                req.onupgradeneeded = e => e.target.result.createObjectStore('playlists', { keyPath: 'id' });
                req.onsuccess = e => { this.instance = e.target.result; this.load(); };
            },
            async save(p) {
                const tx = this.instance.transaction('playlists', 'readwrite');
                tx.objectStore('playlists').put(JSON.parse(JSON.stringify(p)));
            },
            async load() {
                const tx = this.instance.transaction('playlists', 'readonly');
                tx.objectStore('playlists').getAll().onsuccess = e => {
                    AppState.playlists = e.target.result || [];
                    UI.renderPlaylists();
                };
            }
        };

        const Router = {
            go(view) {
                document.querySelectorAll('#app-root > div').forEach(d => d.classList.add('hidden'));
                document.getElementById('view-' + view).classList.remove('hidden');
            },
            openEditor(id) {
                this.go('editor');
                Editor.load(id);
            }
        };

        const UI = {
            toast(msg) {
                const div = document.createElement('div');
                div.className = "bg-brand-blue text-white px-8 py-4 rounded-2xl font-black text-xs uppercase tracking-widest mb-4 shadow-2xl transition-all";
                div.innerText = msg;
                document.getElementById('toast-container').appendChild(div);
                setTimeout(() => div.remove(), 3000);
            },
            renderPlaylists() {
                const tbody = document.getElementById('pl-body');
                tbody.innerHTML = AppState.playlists.map(p => `
                    <tr>
                        <td class="font-black">${p.name}</td>
                        <td class="text-gray-500 font-bold">${p.channels.length} items</td>
                        <td><span class="bg-green-500/10 text-green-500 px-3 py-1 rounded text-[9px] font-black uppercase">Active</span></td>
                        <td class="text-xs font-mono text-gray-600">2027-02-08</td>
                        <td>
                            <button onclick="Router.openEditor('${p.id}')" class="text-brand-blue hover:scale-125 transition-all"><i class="fa-solid fa-pen-to-square"></i></button>
                        </td>
                    </tr>
                `).join('');
            }
        };

        const Editor = {
            load(id) {
                AppState.currentPL = AppState.playlists.find(p => p.id === id);
                document.getElementById('pl-name-label').innerText = AppState.currentPL.name;
                const groups = [...new Set(AppState.currentPL.channels.map(c => c.group))];
                AppState.currentGroup = groups[0];
                this.renderGroups(groups);
                this.renderChannels();
            },
            renderGroups(groups) {
                document.getElementById('group-count').innerText = groups.length;
                document.getElementById('group-list').innerHTML = groups.map(g => `
                    <div onclick="Editor.selectGroup('${g}')" class="p-3 rounded-xl cursor-pointer text-xs flex justify-between items-center ${g === AppState.currentGroup ? 'bg-brand-blue text-white font-bold' : 'text-gray-500 hover:bg-white/5'}">
                        <span>${g}</span>
                    </div>
                `).join('');
            },
            selectGroup(g) { AppState.currentGroup = g; this.renderGroups([...new Set(AppState.currentPL.channels.map(c => c.group))]); this.renderChannels(); },
            renderChannels() {
                const search = document.getElementById('ch-search').value.toLowerCase();
                const filtered = AppState.currentPL.channels.filter(c => c.group === AppState.currentGroup && c.name.toLowerCase().includes(search));
                document.getElementById('channel-list').innerHTML = filtered.map((c, i) => `
                    <tr onclick="Editor.editChannel('${c.id}')" class="${AppState.editingChannel?.id === c.id ? 'selected' : ''}">
                        <td><input type="checkbox"></td>
                        <td><img src="${c.logo}" class="w-8 h-8 object-contain rounded bg-black"></td>
                        <td class="font-bold">${c.name}</td>
                        <td class="text-xs text-gray-600 font-mono">${c.epg || '---'}</td>
                        <td class="text-[10px] font-black opacity-20">#${i+1}</td>
                    </tr>
                `).join('');
            },
            editChannel(id) {
                const c = AppState.currentPL.channels.find(x => x.id === id);
                AppState.editingChannel = c;
                document.getElementById('prop-empty').classList.add('hidden');
                document.getElementById('prop-editor').classList.remove('hidden');
                document.getElementById('attr-name').value = c.name;
                document.getElementById('attr-logo').value = c.logo;
                document.getElementById('attr-epg').value = c.epg;
                this.renderChannels();
            },
            saveChanges() {
                AppState.editingChannel.name = document.getElementById('attr-name').value;
                AppState.editingChannel.logo = document.getElementById('attr-logo').value;
                AppState.editingChannel.epg = document.getElementById('attr-epg').value;
                DB.save(AppState.currentPL);
                UI.toast("Updated Successfully");
                this.renderChannels();
            }
        };

        const IO = {
            importPrompt() {
                const url = prompt("Enter M3U URL:");
                if(url) this.handle(url);
            },
            async handle(url) {
                UI.toast("Connecting...");
                try {
                    const res = await fetch(`https://geminitv-proxy.jcdoni.workers.dev/?url=${encodeURIComponent(url)}`);
                    const text = await res.text();
                    const channels = [];
                    text.split('\n').forEach(line => {
                        if(line.startsWith('#EXTINF:')) {
                            const name = line.split(',')[1]?.trim();
                            const group = (line.match(/group-title="([^"]+)"/) || ["","General"])[1];
                            const logo = (line.match(/tvg-logo="([^"]+)"/) || ["",""])[1];
                            const epg = (line.match(/tvg-id="([^"]+)"/) || ["",""])[1];
                            channels.push({ id: Math.random().toString(36).substr(2,9), name, group, logo, epg });
                        }
                    });
                    const pl = { id: Date.now().toString(), name: "New Source", channels };
                    await DB.save(pl);
                    DB.load();
                    UI.toast("Imported!");
                } catch(e) { UI.toast("Error"); }
            }
        };

        const observer = new IntersectionObserver(es => es.forEach(e => { if(e.isIntersecting) e.target.classList.add('active'); }));
        window.onload = () => { DB.init(); document.querySelectorAll('.reveal').forEach(el => observer.observe(el)); };
    </script>
</body>
</html>
