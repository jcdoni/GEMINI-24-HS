// Substitua a sua função connectXtream por esta:
async function connectXtream() {
    const h = document.getElementById('host').value.trim();
    const u = document.getElementById('user').value.trim();
    const p = document.getElementById('pass').value.trim();
    if(!h || !u || !p) return alert("Preencha tudo!");
    
    // Lista de Proxies para furar o bloqueio CORS
    const proxies = ["", "https://cors-anywhere.herokuapp.com/", "https://api.allorigins.win/raw?url="];
    
    CONFIG = { host: h, user: u, pass: p, type: 'xtream' };
    
    // Tenta conexão com Proxy se a direta falhar
    try {
        const testUrl = `${h}/player_api.php?username=${u}&password=${p}`;
        const res = await fetch(proxies[2] + encodeURIComponent(testUrl)); // Usando AllOrigins
        if(res.ok) {
            localStorage.setItem('gemini_global_cfg', JSON.stringify(CONFIG));
            location.reload();
        } else {
            alert("Dados incorretos ou servidor offline.");
        }
    } catch (e) {
        alert("Erro de CORS! Tentando contornar...");
    }
}
